<!DOCTYPE html>

<html lang="en">
<head>
    <title>BlueFeeds</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon"
    sizes="72x72"
    href="./apple-touch-icon.png"/>

    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
    <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <style>
        label.overBlue
        {
            color: white;
        }
        .loginCenter
        {
            padding-top: 15%;
            height: 25em;
            background-image: url("./med.png"), url("./gradient.jpg");
            background-repeat: no-repeat;
            background-position: 50% 20%;
        }

        #commentText{
            margin-left: 3%;
            margin-right: 3%;
            margin-top: 20%;
            font-size: 150%;
        }
                .input
        {
            padding-left: 12.5%;
            width:75%;
        }

        .newAcctCenter
        {
            height: 25em;
        }
        .hideable{
            display: none;
            position: relative;
        }
        .trigger{
            position: relative;
        }
        #comment
        {
            height: 10em;    
        }
        	#popupPanel-popup {
			right: 0 !important;
			left: auto !important;
		}
		#popupPanel {
			width: 200px;
			border: 1px solid #000;
			border-right: none;
			background: rgba(0,0,0,.5);
			margin: -1px 0;
		}
		#popupPanel .ui-btn {
			margin: 2em 15px;
		}
		#commentBox {
			height : 150px;
		}
		.note
		{
		    -webkit-transform: translateZ(0);
		    overflow:hidden;
		    white-space:nowrap;
		}
		.noteControl
		{
		    -webkit-transform: translateZ(0);

		}
    </style>
</head>
<body>
    
    
<div data-role="page" id="login">
    <header data-role="header" data-theme="b"><h1>BlueFeeds Login</h1></header>
    <div class="loginCenter" data-role="content" data-theme="b">
        <fieldset>
        <form id="loginForm">
            <div data-role="fieldcontain" class="input">
                <label for="usr" class="overBlue">Username</label><input type="text" name="usr" data-mini="true"/>
             </div>
            <div data-role="fieldcontain" class="input">
                <label for="pass" class="overBlue">Password</label><input type="password" class="input" name="pass" data-mini="true"/>
            </div>
            <div data-role="fieldcontain" class="input">
                <label for="submit" class="ui-hidden-accessible" data-theme>Submit</label><button type="submit" data-theme="b" id="submitLogin" name="submit" value="Log In">Log In</button>
            </div>        
        </form>
        </fieldset>
    </div>
    <footer data-role="footer" data-theme="a" data-position="fixed"><nav data-role="navbar">
        <ul>    
            <li><a href="#newAcct" data-icon="plus">New Account</a></li>
        </ul>
    </nav></footer>
</div><!--login page-->


<div data-role="page" id="newAcct">
    <header data-role="header" data-theme="b"><h1>New Account</h1></header>
    <div class="newAcctCenter" data-role="content" data-theme="a">
    <fieldset>
    <form id="newAcctForm">
            <div>
            <label for="name" class="ui-hidden-accessible">Username</label><input type="text" class="in" name="usr" placeholder="Username">
            </div>
            <div>
            <label for="pass" class="ui-hidden-accessible">Password</label><input type="password" class="in" name="pass" placeholder="Password">
            </div>
            <div>
            <label for="passc" class="ui-hidden-accessible">Confirm Password</label><input type="password" class="in" name="passc" placeholder="Confirm Password">
            </div>
            <div>
            <label for="email" class="ui-hidden-accessible">E-Mail</label> <input type="text" class="in" name="email" placeholder="E-mail Address">
            </div>
            <div>
            <label for="title" class="ui-hidden-accessible">Title</label> <input type="text" class="in" name="title" placeholder="Title (e.g. Resident)">
            </div>
            <div>
            <label for="speciality" class="ui-hidden-accessible">Speciality</label> <input type="text" class="in" name="speciality" placeholder="Speciality">
            </div>
            <div>
            <label for="sub" class="ui-hidden-accessible"></label><input data-theme="a" id="submitNew" type="submit" name="sub" value="Create Account">
            </div>

        </form>
        </fieldset>
    </div>
    <footer data-role="footer" data-theme="b" data-position="fixed" value="working?">
        <nav data-role="navbar">
            <ul>
                <li><a href="#login" data-icon="home" data-iconpos="bottom">Back to Login</a></li>
            </ul>
        </nav>
    </footer>
</div><!--new account page-->

<div data-role="page" id="studentSelection">
    <header data-role="header" data-theme="b">
        <h1>My Students</h1>
        <a href="#login" data-theme="a" data-iconpos="notext" data-icon="back"></a>
        <a href="#" data-theme="a" data-iconpos="notext" data-icon="gear"></a>
        </button>
    </header>
    <div class="studentSelectionCenter" data-role="content" data-theme="a">
        <ul data-role="listview" data-filter="true" id="selectionList">
            <li><a href="#">
                    <h1>John Dorian</h1>
                    <img src="./jd.jpg" class="imgTile" alt="J.D"/>
                    <p>Internal Medicine Resident</p>
                </a>
            </li>
            <li><a href="#studentProfile2">
                    <h1>Elliot Reed</h1>
                    <img src="./elliot.jpeg" class="imgTile" alt="Elliot"/>
                    <p>Internal Medicine Resident</p>
                </a>
            </li>
            <li><a href="#studentProfile2">
                    <h1>Chris Turk</h1>
                    <img src="./turk.jpeg" class="imgTile" alt="Turk"/>
                    <p>Surgical Resident</p>
                </a>
            </li>
            <li><a href="#">
                    <h1>Carla Espinosa</h1>
                    <img src="./carla.jpeg" class="imgTile" alt="Carla"/>
                    <p>Nursing Student</p>
                </a>
            </li>
            <li><a href="#">
                    <h1>Janitor</h1>
                    <img src="./janitor.jpeg" class="imgTile" alt="J.D"/>
                    <p>Custodial Student</p>
                </a>
            </li>
        </ul>
    </div>
    <footer data-role="footer" data-theme="b" data-position="fixed">
        <nav data-role="navbar">
            <ul>
                <li><a href="#appointments" data-icon="grid">Appointments</a></li>
                <li><a href="#" data-icon="home">My Students</a></li>
                <li><a href="#addStudent" data-icon="plus">Add Student</a></li>
            </ul>
        </nav>
    </footer>
</div>

<div data-role="page" id="addStudent">
    <header data-role="header" data-theme="b">
        <h1>New Student</h1>
        <a href="#login" data-theme="a" data-iconpos="notext" data-icon="back"></a>
        <a href="#" data-theme="a" data-iconpos="notext" data-icon="gear"></a>
        </button>
    </header>
            
    <div class="addCenter" data-role="content" data-theme="a">
        <form id="studentCreate">
            <div data-role="fieldcontain" class="input">
                <label for="first">First Name</label><input type="text" name="first" data-mini="true"/>
             </div>
            <div data-role="fieldcontain" class="input">
                <label for="last">Last Name</label><input type="text" name="last" data-mini="true"/>
             </div>
            <div data-role="fieldcontain" class="input">
                <label for="email">Email</label><input type="text" class="input" name="email" data-mini="true"/>
            </div>
            <div data-role="fieldcontain" class="input">
                <label for="title">Title</label><input type="text" class="input" name="title" placeholder="e.g. resident" data-mini="true"/>
            </div>
            <div data-role="fieldcontain" class="input">
                <label for="study" >Area of Study</label><input type="text" class="input" name="study" data-mini="true"/>
            </div>
            <div data-role="fieldcontain">
                            <fieldset data-role="controlgroup">
                                <legend>Scheduled Work Days</legend>
                            <label for="tag1">Monday</label>
                            <input type="checkbox" name="tag1" id="tag1" data-mini="true"/>
                            <label for="tag2">Tuesday</label>
                            <input type="checkbox" name="tag2" id="tag2" data-mini="true"/>
                            <label for="tag4">Wednesday</label>
                            <input type="checkbox" name="tag4" id="tag4" data-mini="true"/>
                            <label for="tag3">Thursday</label>
                            <input type="checkbox" name="tag3" id="tag3" data-mini="true"/>
                            <label for="tag5">Friday</label>
                            <input type="checkbox" name="tag5" id="tag5" data-mini="true"/>
                            </fieldset>  
                        </div>
            <div data-role="fieldcontain" class="input">
                <label for="submit" class="ui-hidden-accessible" data-theme>Submit</label><input type="submit" data-theme="b" data-icon="plus" name="submit" id ="studentCreateSubmit" value="Add Student">
            </div>        
        </form>
    </div>          
    <footer data-role="footer" data-theme="b" data-position="fixed">
        <nav data-role="navbar">
            <ul>
                <li><a href="#appointments" data-icon="grid">Appointments</a></li>
                <li><a href="#studentSelection" data-icon="home">My Students</a></li>
                <li><a href="#" data-icon="plus">Add Student</a></li>
            </ul>
        </nav>
    </footer>       
</div>

<div data-role="page" id="appointments">
    <header data-role="header" data-theme="b">
        <h1>Meetings</h1>
        <a href="#login" data-theme="a" data-iconpos="notext" data-icon="back"></a>
        <a href="#" data-theme="a" data-iconpos="notext" data-icon="gear"></a>
        </button>
    </header>
    <div class="appointmentCenter" data-role="content" data-theme="a">
        <ul data-role="listview" data-filter="true">
            <li data-role="list-divider">Wednesday, January 30, 2013 <span class="ui-li-count">2</span></li>
            <li><a href="#">
                    <h1>John Dorian</h1>
                    <p>Weekly Meeting: 12p-1p</p>
                    <img src="./jd.jpg" class="imgTile" alt="J.D"/>
                </a>
            </li>
            <li><a href="#">
                    <h1>Robert Duvall</h1>
                    <img src="./duvall.jpg" class="imgTile" alt="Elliot"/>
                    <p>Weekly Meeting: 4:40p 7:10p</p>
                </a>
            </li>
            <li data-role="list-divider">Thursday, February 1, 2013 <span class="ui-li-count">1</span></li>
            <li><a href="#">
                    <h1>Janitor</h1>
                    <img src="./janitor.jpeg" class="imgTile" alt="J.D"/>
                    <p>8:30a-10a</p>
                </a>
            </li>
            <li data-role="list-divider">Monday, February 5, 2013 <span class="ui-li-count">1</span></li>
            <li><a href="#">
                    <h1>Carla Espinosa</h1>
                    <img src="./carla.jpeg" class="imgTile" alt="Carla"/>
                    <p>11a-12p</p>
                </a>
            </li>
        </ul>
    </div>
    <footer data-role="footer" data-theme="b" data-position="fixed">
        <nav data-role="navbar">
            <ul>
                <li><a href="#" data-icon="grid">Appointments</a></li>
                <li><a href="#quickNote" data-icon="star">Quick Note</a></li>
                <li><a href="#addStudent" data-icon="plus">Add Student</a></li>
            </ul>
        </nav>
    </footer>
</div>

<div data-role="page" data-theme="a" id="studentProfile2">
     <header data-role="header" data-theme="b">
        <h1>Student</h1>
        <a href="#studentSelection" data-theme="a" data-iconpos="notext" data-icon="back"></a>
        <a href="#" data-theme="a" data-iconpos="notext" data-icon="gear"></a>
        </button>
    </header>
    <div data-role="navbar" data-type="horizontal">
	<ul>
		<li data-theme="a"><a href="#studentProfile"  data-theme="b" data-role="button">Flag</a></li>
		<li><a href="#studentProfile" data-theme="b" data-role="button">More Info</a></li>
		<li><a href="#studentProfile" data-theme="b" data-role="button">Tips</a></li>
		
        </ul>
    </div>
    <div class="studentSelectionCenter" data-role="content" data-theme="a">
        <ul data-role="listview" id="profileInfo">
	    <li>
		<a href="#addcomment">
		    <h1>New Note</h1>
		    <p>add feedback for this student</p>
		</a>
	    </li>
            <li><a href="#commentspage">
		    <h1>QuickNotes</h1>
		    <p>View past comments about this student</p>
		    <span class="ui-li-count">12</span></a>
	    </li>
	    <li><a href="#appointments">
		    <h1>Appointments</h1>
		    <p>View upcoming meetings with this student</p>
		    <span class="ui-li-count">0</span>
		</a>
	    </li>
        </ul>
    </div>
    <footer data-role="footer" data-theme="b" data-position="fixed">
        <nav data-role="navbar">
            <ul>
                <li><a href="#appointments" data-icon="grid">Appointments</a></li>
                <li><a href="#studentSelection" data-icon="home">My Students</a></li>
                <li><a href="#addStudent" data-icon="plus">Add Student</a></li>
            </ul>
        </nav>
    </footer>
</div><!--new profile page, with list-->

<div data-role="page" data-theme="a" id="commentspage">
    <header data-role="header" data-theme="b"><h1>Comments</h1>
    <a href="#studentProfile2" data-theme="a" data-iconpos="notext" data-icon="back"></a>
    </header>
	<div class="commentCenter" data-role="content" data-theme="a">
            <div style="margin-bottom: 15%;">
            <a href="#addcomment" data-theme="b" data-role="button" data-icon="plus" class="topButton">Add Comment</a>
            </div>
        <ul data-role="listview" id="parent">

	</ul>
	</div>
    <footer data-role="footer" data-theme="b" data-tap-toggle="false" data-position="fixed" value="working?">
        <nav data-role="navbar">
            <ul>
                <li><a href="#appointments" data-icon="grid">Appointments</a></li>
                <li><a href="#studentSelection" data-icon="home">My Students</a></li>
                <li><a href="#addStudent" data-icon="plus">Add Student</a></li>
            </ul>
        </nav>
    </footer>
</div><!--comments page-->



<div data-role="page" id="addcomment">
    <header data-role="header" data-theme="b"><h1>Add Comment</h1>
    <a href="#commentspage" data-theme="a" data-iconpos="notext" data-icon="back"></a>
    </header>
	<div class="commentSelection" data-role="content" data-theme="b" align="center">
        <form id="commentForm">
        <label for="title">Title This Post</label><input type="text" name="title">
        <label for="textarea">What would you like to change?</label>
        <textarea name="comment" id="comment">
        </textarea>
        </form>
        <button data-theme="a" type="submit" data-icon="check" id="commentSubmit">Save Comment</button>     
        <button data-theme="a" data-icon="star">Flag Comment</button> 
        <button data-theme="a" data-icon="edit">Tag Comment</button>                               
	</div>
    <footer data-role="footer" data-theme="b" data-position="fixed" value="working?">
       <nav data-role="navbar">
            <ul>
                <li><a href="#appointments" data-icon="grid">Appointments</a></li>
                <li><a href="#studentSelection" data-icon="home">My Students</a></li>
                <li><a href="#addStudent" data-icon="plus">Add Student</a></li>
            </ul>
        </nav>
    </footer>
</div><!--add comments page-->

<div data-role="page" id="editcomment">
    <header data-role="header" data-theme="b"><h1>Edit Comment</h1>
    <a href="#commentspage" data-theme="a" data-iconpos="notext" data-icon="back"></a>
    </header>
	<div class="commentSelection" data-role="content" data-theme="b" align="center">
        <form id="commentEditForm">
        <label for="textarea">What would you like to change?</label>
        <textarea name="comment" id="commentBox">
        </textarea>
        <input type="text" name="CUID" id="CUID" style="display: none;">
        </form>
        <button data-theme="a" type="submit" id="commentEdit" data-icon="check">Save Comment</button>     
        <button data-theme="a" data-icon="star">Flag Comment</button> 
        <button data-theme="a" data-icon="delete" id="commentDelete">Discard Comment</button>                               
	</div>
    <footer data-role="footer" data-theme="b" data-position="fixed" value="working?">
        <nav data-role="navbar">
            <ul>
                <li><a href="#appointments" data-icon="grid">Appointments</a></li>
                <li><a href="#studentSelection" data-icon="home">My Students</a></li>
                <li><a href="#addStudent" data-icon="plus">Add Student</a></li>
            </ul>
        </nav>
    </footer>
</div><!--edit comments page-->

<div data-role="page" id='viewcomment'>
    <header data-role="header" data-theme="b"><h1 id="commentHeader"></h1>
    <a href="#commentspage" data-theme="a" data-iconpos="notext" data-icon="back"></a>
    </header>
    <div>
    <p id="commentText"></p>
    </div>
    <footer data-role="footer" data-theme="b" data-position="fixed" value="working?">
    <nav data-role="navbar">
            <ul>
                <li><a href="#appointments" data-icon="grid">Appointments</a></li>
                <li><a href="#studentSelection" data-icon="home">My Students</a></li>
                <li><a href="#addStudent" data-icon="plus">Add Student</a></li>
            </ul>
        </nav>
    </footer>
</div>


<script>
    function onLogin(data,status){
        if(data=="true"){
            $.mobile.changePage("#studentSelection");
        }
        else{
            alert(data);
        }
    }
    
    function onSelection(data,success){
        $("#selectionList").append(data)
        $("#selectionList").listview("refresh");
        $(".imgTile").load(function(){
            $(".dynamicProfile").slideDown();
        });  
    }
    
    function onSecondSelect(data,status){    
    }
    
    function onProfile(data,status){
        $("#profileInfo").prepend(data)
        $("#profileInfo").listview("refresh");
        $(".imgTile").load(function(){
            $(".dynamicProfile").slideDown();
        });
    }
    
    function onComment(data,status){
        if(data=="true"){
            $.mobile.changePage("#studentProfile2");
        }
        else{
            alert(data);
        }
    }
    
    function onCommentPage(data,status){
        $("#parent").append(data).trigger("create");
        $("#parent").listview("refresh");
    }
    
    function onCreate(data,status){
        if(data=="true"){
            $.mobile.changePage("#login");
        }
        else{
            alert(data);
        }
    }
    
    function onStudentCreate(data,status){
        alert(data);
        if(data=="true"){
            $.mobile.changePage("#studentSelection");
        }
        else{
            alert(data);
        }
    }
    function onError(data,status){
        alert("error!!!"+data);
    }
    $(document).bind('pageinit');

        $(document).ready(function(){
            $("#submitLogin").click(function(){
                    var formData=$("#loginForm").serialize();
                    $.ajax({async: false, type:"POST", url: "login.php", data: formData, success: onLogin, error:onError});
                    return false;
                });
        });

        $(document).ready(function(){
            $("#submitNew").click(function(){
                    var formData=$("#newAcctForm").serialize();
                    $.ajax({type:"POST", url: "usrCreate.php", data: formData, success: onCreate, error:onError});
                    return false;
                });
        });
        
        $(document).ready(function(){
            $("#studentCreateSubmit").click(function(){
                    var formData=$("#studentCreate").serialize();
                    $.ajax({type:"POST", url: "studentCreate.php", data: formData, success: onStudentCreate, error:onError});
                    return false;
                });
        });
        
        $(document).ready(function(){
            $(':jqmData(url^=commentspage)').live('pagebeforecreate', 
                function(event) {
                 $(this).filter(':jqmData(url*=ui-page)').find(':jqmData(role=header)')
                .prepend('<a href="#" data-rel="back" data-icon="back">Back</a>')
            });
            
        });
        
        $(document).ready(
	function(){
	    $("#parent").on("click", "li", function(e){
                if($.trim($(e.target).parents('a').text())=='Edit'){
                    $("#commentBox").val($(this).children(".note").text());
                    $("#CUID").val($(this).children(".hiddenForm").val());
                }
                
                if($.trim($(e.target).parents('a').text())=='View'){
                    $("#commentHeader").text($(this).children('h1').text());
                    $("#commentText").text($(this).children('.note').text());
                }
                
		});	    
	    });

            
        $(document).ready(
	function(){
	    $("#selectionList").on("click", "li", function(e){
                var found=$(this).find("#no").val();
                $.ajax({type: "POST", url: "setStudent.php", data: {'key':found}, success: onSecondSelect, error: onError})
		});	    
	    });
        
        $(document).ready(function(){
            $("#commentSubmit").click(function(){
               var formData=$("#commentForm").serialize();
               $.ajax({type:"POST", url: "commentSubmit.php", data: formData, success: onComment, error:onError});
            });
        });
        
        
        $(document).ready(function(){
            $("#commentEdit").click(function(){
               var formData=$("#commentEditForm").serialize();
               $.ajax({type:"POST", url: "commentEdit.php", data: formData, success: onComment, error:onError});
            });
        });
        
        $(document).ready(function(){
            $("#commentDelete").click(function(){
               var formData=$("#commentEditForm").serialize();
               $.ajax({type:"POST", url: "commentDelete.php", data: formData, success: onComment, error:onError});
            });
        });
        
        $(document).ready(function(){
        $(document).on('pagechange', function (e,data) {
            if(data.toPage.attr("id")=="studentProfile2"){
                $.ajax({url: "profile.php", success: onProfile, error:onError});}
            
            else{
                $(".dynamicProfile").remove();
            }
            });
        });
        
        $(document).ready(function(){
        $(document).on('pagechange', function (e,data) {
            if(data.toPage.attr("id")=="commentspage"){
                $.ajax({url: "commentRetrieve.php", success: onCommentPage, error:onError});}
            
            else{
                $(".dynamicComment").remove();
            }
            });
        });
        
        $(document).ready(function(){
        $(document).on('pagechange', function (e,data) {
            if(data.toPage.attr("id")=="studentSelection"){
               $.ajax({url: "selection.php", success: onSelection, error: onError});
            }
            else{
                $(".dynamicSelection").remove();
            }
            });
        });
</script>
</body>
</html>
